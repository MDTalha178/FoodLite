<!DOCTYPE html>
<html>
<head>
  <title>Customer Dashboard</title>
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .sidebar {
      height: 100vh;
      width: 230px;
      position: fixed;
      top: 0;
      left: 0;
      background-color: #343a40;
      color: white;
      padding-top: 30px;
    }
    .sidebar a {
      display: block;
      color: white;
      padding: 12px 20px;
      text-decoration: none;
    }
    .sidebar a:hover {
      background-color: #495057;
    }
    .content {
      margin-left: 250px;
      padding: 30px;
    }
    .card-summary {
      border-radius: 15px;
    }
  </style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar">
  <h4 class="text-center mb-4">üç¥ Food Delivery</h4>
  <a href="{% url 'customer_dashboard' %}">üè† Dashboard</a>
  <a href="{% url 'create_booking' %}">‚ûï New Booking</a>
  <a href="#">üì¶ My Bookings</a>
  <a href="{% url 'logout' %}">üö™ Logout</a>
</div>

<!-- Main Content -->
<div class="content">
  <h3 class="mb-4">Welcome, {{ request.user.first_name }} üëã</h3>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  {% endif %}

  <!-- Summary Cards -->
  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card text-center shadow-sm card-summary bg-primary text-white">
        <div class="card-body">
          <h5>Total Bookings</h5>
          <h3>{{ total_bookings }}</h3>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center shadow-sm card-summary bg-success text-white">
        <div class="card-body">
          <h5>Delivered</h5>
          <h3>{{ delivered }}</h3>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center shadow-sm card-summary bg-warning text-dark">
        <div class="card-body">
          <h5>Pending / Active</h5>
          <h3>{{ pending }}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- Active Bookings Section -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h5>Current / Pending Bookings</h5>
    <a href="{% url 'create_booking' %}" class="btn btn-success btn-sm">+ Create Booking</a>
  </div>

  <table class="table table-striped bg-white shadow-sm">
    <thead>
      <tr>
        <th>ID</th>
        <th>Pickup</th>
        <th>Drop</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for booking in bookings %}
      <tr>
        <td>{{ booking.id }}</td>
        <td>{{ booking.pickup_location }}</td>
        <td>{{ booking.drop_location }}</td>
        <td>
          <span class="badge
            {% if booking.status == 'pending' %}bg-warning text-dark
            {% elif booking.status == 'assigned' %}bg-info
            {% elif booking.status == 'delivered' %}bg-success
            {% else %}bg-secondary{% endif %}">
            {{ booking.status|title }}
          </span>
        </td>
        <td>
          {% if booking.status == 'pending' %}
            <a href="{% url 'cancel_booking' booking.id %}" class="btn btn-danger btn-sm">Cancel</a>
          {% elif booking.status == 'assigned' %}
            <a href="{% url 'chat' booking.id %}" class="btn btn-primary btn-sm">Chat</a>
          {% elif booking.status == 'delivered' %}
            <span class="text-success">‚úî Delivered</span>
          {% else %}
            -
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="5" class="text-center text-muted">No bookings yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

</body>
</html>
